<!doctype html>
<html lang="zh-Hant">
<head>
    <meta charset="utf-8">
    <title>商品列表</title>
    <link rel="stylesheet" type="text/css" href="/css/public.css">
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }
        th, td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #b4c8ed;
        }
        .even-row {
            background-color: #ffffff;
        }
        .odd-row {
            background-color: #edf8ff;
        }
        .pagination {
            list-style-type: none;
            padding: 0;
            text-align: center;
        }
        .pagination li {
            display: inline;
            margin: 0 5px;
        }
        .pagination a {
            text-decoration: none;
            padding: 5px 10px;
            border: 1px solid #ddd;
            border-radius: 3px;
        }
        .pagination .active a {
            background-color: #b4c8ed;
            color: white;
        }
    </style>
</head>
<body>
<div align="center">請從商品列表中選擇您喜愛的商品</div>
<br>
<table id="goodsTable" border="0" align="center">
    <thead>
    <tr>
        <th>商品名稱</th>
        <th width="15%">商品價格</th>
        <th width="20%">添加到購物車</th>
    </tr>
    </thead>
    <tbody>
    <!-- 商品数据将通过 JavaScript 填充 -->
    </tbody>
</table>
<hr />
<div align="center" id="pagination"></div>

<script>
    async function fetchGoods(page = 1) {
        const limit = 5; // 每頁商品數
        const response = await fetch(`/goods?page=${page}`);
        const data = await response.json();

        const goodsList = data.result;
        const totalPageNumber = Math.ceil(data.total / limit);

        const goodsTableBody = document.querySelector('#goodsTable tbody');
        goodsTableBody.innerHTML = ''; // 清空表格内容

        goodsList.forEach((goods, index) => {
            const row = goodsTableBody.insertRow();
            row.className = index % 2 === 0 ? 'even-row' : 'odd-row';

            const cell1 = row.insertCell(0);
            cell1.innerHTML = `<a href="/goods/${goods.id}">${goods.name}</a>`;

            const cell2 = row.insertCell(1);
            cell2.textContent = `$${goods.price}`;

            const cell3 = row.insertCell(2);
            cell3.innerHTML = `<a href="/goods/add?id=${goods.id}&name=${goods.name}&price=${goods.price}">添加到購物車</a>`;
        });

        renderPagination(totalPageNumber, page);
    }

    function renderPagination(totalPages, currentPage) {
        const pagination = document.getElementById('pagination');
        pagination.innerHTML = `<ul class="pagination">
            <li><a href="#" onclick="goToPage(1)">«</a></li>
            ${Array.from({ length: totalPages }, (_, i) => `
                <li class="${i + 1 === currentPage ? 'active' : ''}">
                    <a href="#" onclick="goToPage(${i + 1})">${i + 1}</a>
                </li>
            `).join('')}
            <li><a href="#" onclick="goToPage(${totalPages})">»</a></li>
        </ul>`;
    }

    function goToPage(page) {
        fetchGoods(page);
    }

    window.onload = () => fetchGoods();
</script>
</body>
</html>